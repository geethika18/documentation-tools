<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: kasclient_app.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: kasclient_app.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>App
        /**

        * To simulate clients on older versions, versions starting from "0", "1", "2", ...

        * @param {string} version

        */

        function setCompatibilityMode(version) {

            KASClient.Version.setClientSupportedVersion(version);

        }

        App.setCompatibilityMode = setCompatibilityMode;

        /**

        * Gets users' details (name, pic, phone number, etc.) against their ids

        * @param {string[]} userIds array of user ids

        * @param {Callback} callback with below parameters:

        * * * * @param {Dictionary&lt;UserId: string, UserInfo: KASUser>} userIdToInfoMap (users' details against their ids) can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getUsersDetailsAsync(userIds, callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                KASClient.getJsonFromFileAsync("mock/user.json", function (userJson, error) {

                    var userIdToInfoMap = {};

                    for (var i = 0; i &lt; userIds.length; i++) {

                        var userId = userIds[i];

                        var userInfo = userJson;

                        userInfo["id"] = "USR_" + userId;

                        userInfo["uId"] = userId;

                        userIdToInfoMap[userId] = KASClient.KASUser.fromJSON(userInfo);

                    }

                    if (callback) {

                        callback(userIdToInfoMap, null);

                    }

                });

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getUserDetails(userIds, function (userIdToInfoJson, error) {

                var userIdToInfoMap = {};

                for (var userId in userIdToInfoJson) {

                    var userInfo = userIdToInfoJson[userId];

                    if (typeof userInfo === "string") {

                        userInfo = KASClient.parseJsonObject(userInfo);

                    }

                    userIdToInfoMap[userId] = KASClient.KASUser.fromJSON(userInfo);

                }

                if (callback) {

                    callback(userIdToInfoMap, error);

                }

            });

        }

        App.getUsersDetailsAsync = getUsersDetailsAsync;

        /**

        * Shows profile page/details of a user

        * @param {string} userId of the user whose profile is to be shown

        * @param {boolean} isMiniProfile whether to show mini-profile first

        */

        function showUserProfileAsync(userId, isMiniProfile, callback) {

            KASClient.showUserProfilePage(userId, isMiniProfile, function (success, error) {

                if (callback) {

                    callback(success, error);

                }

            });

        }

        App.showUserProfileAsync = showUserProfileAsync;

        /**

        * Starts chat with a user

        * @param {string} userId of the user

        */

        function startChatAsync(userId, callback) {

            KASClient.startChat(userId, function (success, error) {

                if (callback) {

                    callback(success, error);

                }

            });

        }

        App.startChatAsync = startChatAsync;

        /**

        * Gets users' details (name, pic, phone number, etc.) against their ids

        * @param {Callback} callback with below parameters:

        * * * * @param {string} token got from integeration service

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getIntegerationServiceTokenAsync(callback) {

            KASClient.getIntegerationServiceToken(function (token, error) {

                if (callback) {

                    callback(token, error);

                }

            });

        }

        App.getIntegerationServiceTokenAsync = getIntegerationServiceTokenAsync;

        /**

        * Gets deviceId

        * @param {Callback} callback with below parameters:

        * * * * @param {string} deviceId got from integeration service

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getDeviceIdAsync(callback) {

            KASClient.getDeviceId(function (deviceId, error) {

                if (callback) {

                    callback(deviceId, error);

                }

            });

        }

        App.getDeviceIdAsync = getDeviceIdAsync;

        /**

        * Shows a native contact picker, and returns an array of all the selected users' details

        * @param {string} title of Contact Picker

        * @param {string[]} selectedMutableUser array of selected userIds

        * @param {string[]} selectedImmutableUser array of fixed selected userIds

        * @param {boolean} isSingleSelection single selection in Contact Picker

        * @param {Callback} callback with below parameters:

        * * * * @param {KASUser[]} selectedUsers (array of user details) can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function showContactPickerAsync(title, selectedMutableUser, selectedImmutableUser, isSingleSelection, callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                KASClient.getJsonFromFileAsync("mock/user.json", function (userJson, error) {

                    var userInfo = KASClient.KASUser.fromJSON(userJson);

                    if (callback) {

                        callback([userInfo, userInfo, userInfo], null);

                    }

                });

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getSelectedUsers([title, selectedMutableUser, selectedImmutableUser, isSingleSelection], function (usersJson, error) {

                var users = [];

                for (var i in usersJson) {

                    users.push(KASClient.KASUser.fromJSON(usersJson[i]));

                }

                if (callback) {

                    callback(users, error);

                }

            });

        }

        App.showContactPickerAsync = showContactPickerAsync;

        /**

        * Gets whether talkback is enabled or not

        * @param {Callback} callback with below parameters:

        * * * * @param {boolean} talkBackEnabled true if talkback is enabled

        */

        function isTalkBackEnabledAsync(callback) {

            KASClient.isTalkBackEnabled(function (talkBackEnabled, error) {

                if (callback &amp;&amp; error == null) {

                    callback(talkBackEnabled);

                }

            });

        }

        App.isTalkBackEnabledAsync = isTalkBackEnabledAsync;

        /**

        * Reads the text if TalkBack/VoiceOver enabled

        * @param {talkBackText} string to read by talkback

        */

        function readTalkBackMessage(talkBackMessage) {

            KASClient.readTalkBackMessageNative(talkBackMessage);

        }

        App.readTalkBackMessage = readTalkBackMessage;

        /**

        * Shows a native image picker, and returns the selected image path

        * @param {Callback} callback with below parameters:

        * * * * @param {string} selectedImagePath can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function showImagePickerAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                if (callback) {

                    callback("file://DummyAttachmentPath", null);

                }

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getAttachmentPath(callback);

        }

        App.showImagePickerAsync = showImagePickerAsync;

        /**

         * Displays an attachment picker in the native layer

         * @param supportedTypes array of supported attachment types for the picker.

         * @param props additional props to configure the picker

         * @param callback callback with list of selected attachments

         */

        function showAttachmentPickerAsync(supportedTypes, props, callback) {

            KASClient.getAttachmentPaths([supportedTypes, JSON.stringify(props)], function (selectedAttachmentJson, error) {

                var selectedAttachments = [];

                for (var i in selectedAttachmentJson) {

                    selectedAttachments.push(KASClient.KASAttachmentFactory.fromJSON(JSON.parse(selectedAttachmentJson[i])));

                }

                if (callback) {

                    callback(selectedAttachments, error);

                }

            });

        }

        App.showAttachmentPickerAsync = showAttachmentPickerAsync;

        /**

         * Download the attachment specified

         * @param attachment attachment with a valid server path to download

         * @param callback callback on download completion

         */

        function downloadAttachmentAsync(attachment, callback) {

            KASClient.downloadAttachment(attachment.toJSON(), function (downloadedAttachmentJSON, error) {

                var downloadedAttachment = KASClient.KASAttachmentFactory.fromJSON(downloadedAttachmentJSON);

                if (callback) {

                    callback(downloadedAttachment, error);

                }

            });

        }

        App.downloadAttachmentAsync = downloadAttachmentAsync;

        /**

        * Download the attachment specified

        * @param attachment attachment with a valid server path to download

        * @param callback callback on download completion

        */

        function isAttachmentDownloadingAsync(attachment, callback) {

            KASClient.isAttachmentDownloading(attachment.toJSON(), function (isAttachmentDownloadingOrDownLoaded, error) {

                if (callback) {

                    callback(isAttachmentDownloadingOrDownLoaded, error);

                }

            });

        }

        App.isAttachmentDownloadingAsync = isAttachmentDownloadingAsync;

        /**

         * Cancel a download operation queued for an attachment

         * @param attachment

         */

        function cancelAttachmentDownloadAsync(attachment, callback) {

            KASClient.cancelAttachmentDownload(attachment.toJSON(), function (error) {

                if (callback) {

                    callback(error);

                }

            });

        }

        App.cancelAttachmentDownloadAsync = cancelAttachmentDownloadAsync;

        /**

        * Shows a native place picker, and returns the selected place (lt, lg, n)

        * @param {Callback} callback with below parameters:

        * * * * @param {KASLocation} selectedLocation can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function showPlacePickerAsync(callback) {

            KASClient.showPlacePicker(function (locationJson, error) {

                if (callback) {

                    callback(KASClient.KASLocation.fromJSON(locationJson), error);

                }

            });

        }

        App.showPlacePickerAsync = showPlacePickerAsync;

        /**

        * Launches the barcode scanner and returns the scanned object

        * @param {Callback} callback with below parameters:

        * * * * @param {string} barcodeInfo can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function showBarcodeScannerAsync(callback) {

            KASClient.showBarcodeScanner(function (barcodeInfo, error) {

                if (callback) {

                    callback(barcodeInfo, error);

                }

            });

        }

        App.showBarcodeScannerAsync = showBarcodeScannerAsync;

        /**

          * Launches the QR code scanner and returns the scanned object

          * @param {Callback} callback with below parameters:

          * * * * @param {string} qrCodeInfo can be null in case of error

          * * * * @param {string} error message in case of error, null otherwise

          */

        function showQRcodeScannerAsync(callback) {

            KASClient.showQRcodeScanner(function (qrCodeInfo, error) {

                if (callback) {

                    callback(qrCodeInfo, error);

                }

            });

        }

        App.showQRcodeScannerAsync = showQRcodeScannerAsync;

        /**

        * Shows a native duration picker with day/hour/minute

        * @param {number} defaultDurationInMinutes the default duration to be shown on picker

        * @param {Callback} callback with below parameters:

        * * * * @param {number} durationInMinutes selected duration in minutes

        * * * * @param {string} error message in case of error, null otherwise

        */

        function showDurationPickerAsync(defaultDurationInMinutes, callback) {

            KASClient.showDurationPicker(defaultDurationInMinutes, function (durationString, error) {

                if (callback) {

                    callback(parseInt(durationString), error);

                }

            });

        }

        App.showDurationPickerAsync = showDurationPickerAsync;

        /**

        * Gets the previously stored device location

        * @param {Callback} callback with below parameters:

        * * * * @param {string} location can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getDeviceLocationAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                KASClient.getJsonFromFileAsync("mock/location.json", function (locationJson, error) {

                    if (callback) {

                        callback(JSON.stringify(locationJson), null);

                    }

                });

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getLocation(callback);

        }

        App.getDeviceLocationAsync = getDeviceLocationAsync;

        /**

        * Gets the new UUID

        * @param {Callback} callback with below parameters:

        * * * * @param {string} uuid newly generated uuid

        * * * * @param {string} error message in case of error, null otherwise

        */

        function generateUUIDAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                callback(JSON.stringify(""), null);

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.generateUUID(callback);

        }

        App.generateUUIDAsync = generateUUIDAsync;

        /**

        * Gets the current device location

        * @param {Callback} callback with below parameters:

        * * * * @param {string} location can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getCurrentDeviceLocationAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                KASClient.getJsonFromFileAsync("mock/location.json", function (locationJson, error) {

                    if (callback) {

                        callback(JSON.stringify(locationJson), null);

                    }

                });

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getCurrentLocation(callback);

        }

        App.getCurrentDeviceLocationAsync = getCurrentDeviceLocationAsync;

        /**

        * Shows a native alert (for iOS) or a toast (for Android) with the message

        * @param {string} message

        */

        function showNativeErrorMessage(message) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                alert(message);

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.showAlert(message);

        }

        App.showNativeErrorMessage = showNativeErrorMessage;

        /**

        * Gets the current app locale, the language in which the app is rendered, useful for localizing MiniApp's strings

        * @param {Callback} callback with below parameters:

        * * * * @param {string} locale can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getAppLocaleAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                if (callback) {

                    callback("en", null);

                }

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getAppLocale(callback);

        }

        App.getAppLocaleAsync = getAppLocaleAsync;

        /**

        * Gets the current app time format is 24hours or not, the time format selected by user, useful for formatting date time strings properly

        * @param {Callback} callback with below parameters:

        * * * * @param {string} isAppTimeFormat24Hours can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getIsAppTimeFormat24HoursAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                if (callback) {

                    callback(false, null);

                }

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getIs24HourTimeFormat(callback);

        }

        App.getIsAppTimeFormat24HoursAsync = getIsAppTimeFormat24HoursAsync;

        /**

        * Gets the current system calendar setting. This is mainly for iOS to identify the calendar name set in phone setting like Gregorian or Japanese or Buddhists.

        * @param {Callback} callback with below parameters:

        * * * * @param {string} calendarName can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getCalendarNameAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                if (callback) {

                    callback('-u-ca-gregory', null);

                }

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getCalendarName(callback);

        }

        App.getCalendarNameAsync = getCalendarNameAsync;

        /**

        * Gets all the participant-ids of the current conversation

        * @param {Callback} callback with below parameters:

        * * * * @param {string} name can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getConversationParticipantsCountAsync(callback) {

            KASClient.getConversationParticipantsCount(function (participantsCount, error) {

                if (callback) {

                    callback(parseInt(participantsCount), error);

                }

            });

        }

        App.getConversationParticipantsCountAsync = getConversationParticipantsCountAsync;

        /**

        * Gets all the participant-ids of the current conversation

        * @param {Callback} callback with below parameters:

        * * * * @param {string[]} participants Array of members for the  current group. Will return empty array if user if not the member of the group.

        */

        function getConversationParticipantsAsync(callback) {

            KASClient.getConversationParticipants(function (participants, error) {

                var userIds = [];

                for (var i in participants) {

                    userIds.push(participants[i]);

                }

                if (callback) {

                    callback(userIds, error);

                }

            });

        }

        App.getConversationParticipantsAsync = getConversationParticipantsAsync;

        /**

        * Gets the current conversation name

        * @param {Callback} callback with below parameters:

        * * * * @param {string} name can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getConversationNameAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                if (callback) {

                    callback("The Conversation", null);

                }

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getConversationName(callback);

        }

        App.getConversationNameAsync = getConversationNameAsync;

        /**

        * Gets the current conversation type

        * @param {Callback} callback with below parameters:

        * * * * @param {number} conversationType can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getConversationTypeAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                if (callback) {

                    callback(0, null);

                }

                return;

            }

            KASClient.getConversationType(function (conversationType, error) {

                if (callback) {

                    callback(parseInt(conversationType), error);

                }

            });

        }

        App.getConversationTypeAsync = getConversationTypeAsync;

        /**

        * Dismiss the current screen (Creation, Response, or Summary)

        */

        function dismissCurrentScreen() {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                alert("dismissCurrentScreen");

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.dismissScreen();

        }

        App.dismissCurrentScreen = dismissCurrentScreen;

        /**

        * Shows a native full sreen progress bar with the given text

        * @param {string} text

        */

        function showProgressBar(text) {

            KASClient.showProgress(text);

        }

        App.showProgressBar = showProgressBar;

        /**

        * Hides the current progress bar, if any

        */

        function hideProgressBar() {

            KASClient.hideProgress();

        }

        App.hideProgressBar = hideProgressBar;

        /**

        * Gets the current user id who has opened the MiniApp

        * @param {Callback} callback with below parameters:

        * * * * @param {string} userId can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getCurrentUserIdAsync(callback) {

            //////////// MOCK ////////////

            if (KASClient.shouldMockData()) {

                if (callback) {

                    callback("7dc6f31a-28ec-4c9b-91bb-ecf3ef5f4a0c", null);

                }

                return;

            }

            //////////// ACTUAL ////////////

            KASClient.getCurrentUserId(callback);

        }

        App.getCurrentUserIdAsync = getCurrentUserIdAsync;

        /**

        * Sets few properties when using native toolbar

        * @param {KASNativeToolbarProperties} properties

        */

        function setNativeToolbarProperties(properties) {

            KASClient.customizeNativeToolbar(properties.toJSON());

        }

        App.setNativeToolbarProperties = setNativeToolbarProperties;

        /**

        * Gets the package properties (user given)

        * @param {Callback} callback with below parameters:

        * * * * @param {JSON} properties can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getPackagePropertiesAsync(callback) {

            KASClient.getPackageProperties(callback);

        }

        App.getPackagePropertiesAsync = getPackagePropertiesAsync;

        /**

        * Shows Image in Immersive view.

        * @param {string[]} urls Array of images url:

        */

        function showImageImmersiveView(urls, currentImageIndex) {

            if (urls === void 0) { urls = []; }

            if (currentImageIndex === void 0) { currentImageIndex = 0; }

            KASClient.showImageInFullScreen(urls, currentImageIndex);

        }

        App.showImageImmersiveView = showImageImmersiveView;

        /**

        * Open attachment in Immersive view.

        * @param {KASAttachment} attachmentObj

        */

        function openAttachmentImmersiveView(attachmentObj) {

            KASClient.openImmersiveViewForAttachment(attachmentObj.toJSON());

        }

        App.openAttachmentImmersiveView = openAttachmentImmersiveView;

        /**

        * Open attachment in Immersive view.

        * @param {KASAttachment} attachmentObj

        */

        function openImmersiveViewForAttachmentList(attachmentList, atIndex) {

            if (atIndex === void 0) { atIndex = 0; }

            var attachmentListJSON = JSON.parse("[]");

            for (var i = 0; i &lt; attachmentList.length; i++) {

                attachmentListJSON.push(attachmentList[i].toJSON());

            }

            KASClient.openAttachmentListImmersiveView(attachmentListJSON, atIndex);

        }

        App.openImmersiveViewForAttachmentList = openImmersiveViewForAttachmentList;

        /**

       * checks whether app has read/write access to the storage

       * @param {KASAttachmentType} attachmentType

       */

        function hasStorageAccessForAttachmentType(type, callback) {

            KASClient.hasStorageAccessForType(type, callback);

        }

        App.hasStorageAccessForAttachmentType = hasStorageAccessForAttachmentType;

        /**

        * Generates Base64 thumbnail for an image whose localPath is given

        * @param {string} localPath localPath for the imageAttachment whose thumbnail needs to be generated:

        */

        function generateBase64ThumbnailAsync(localPath, callback) {

            if (KASClient.isPDFDocument(localPath)) {

                KASClient.generateBase64ThumbnailForPDFAttachment(localPath, callback, false);

            }

            else {

                KASClient.generateBase64ThumbnailForAttachment(localPath, callback);

            }

        }

        App.generateBase64ThumbnailAsync = generateBase64ThumbnailAsync;

        /**

         * Gets the font size multiplier for large text.

         * Current only required by iOS.

         */

        function getFontSizeMultiplierAsync(callback) {

            KASClient.getFontSizeMultiplier(callback);

        }

        App.getFontSizeMultiplierAsync = getFontSizeMultiplierAsync;

        /**

        * Gets the localized strings' dictionary based on current app locale.

        * Strings must be provided inside the package with names like: strings_en.json, strings_hi.json, etc.

        * @param {Callback} callback with below parameters:

        * * * * @param {JSON} strings can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getLocalizedStringsAsync(callback) {

            KASClient.getLocalizedMiniAppStrings(callback);

        }

        App.getLocalizedStringsAsync = getLocalizedStringsAsync;

        /**

        * Gets all the customization settings for a package (Used in case of Type-4 packages and their base).

        * @param {Callback} callback with below parameters:

        * * * * @param {JSON} settings can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getPackageCustomSettingsAsync(callback) {

            KASClient.getPackageCustomSettings(callback);

        }

        App.getPackageCustomSettingsAsync = getPackageCustomSettingsAsync;

        /**

        * Logs an error for "Send report"

        * @param {string} error string

        */

        function logError(error) {

            KASClient.logErrorNative(error);

        }

        App.logError = logError;

        /**

        * Logs data for "Send report"

        * @param {string} data string

        */

        function logToReport(data) {

            KASClient.logToReportNative(data);

        }

        App.logToReport = logToReport;

        /**

        * Recording event for load and error telemetry

        * @param {string} eventName string

        * @param {string} eventType string

        * @param {string} props JSON

        */

        function recordEvent(eventName, eventType, props) {

            if (props === void 0) { props = JSON.parse("{}"); }

            KASClient.recordEventNative(eventName, eventType, props);

        }

        App.recordEvent = recordEvent;

        /**

        * Recording event for independent telemetry

        * @param {string} eventName string

        * @param {string} props JSON

        */

        function recordTelemetryEvent(eventName, props) {

            if (props === void 0) { props = JSON.parse("{}"); }

            KASClient.recordEventNative(eventName, "INDEPENDENT", props);

        }

        App.recordTelemetryEvent = recordTelemetryEvent;

        /**

        * Checks if the current user an O365 subscriber

        * @param {Callback} callback with below parameters:

        * * * * @param {boolean} subscribed true if subscribed, false otherwise

        */

        function isCurrentUserO365SubscribedAsync(callback) {

            KASClient.isCurrentUserO365Subscribed(function (subscribed, error) {

                if (callback) {

                    callback(subscribed &amp;&amp; error == null);

                }

            });

        }

        App.isCurrentUserO365SubscribedAsync = isCurrentUserO365SubscribedAsync;

        /**

        * Gets details of current logged-in O365 user

        * @param {Callback} callback with below parameters:

        * * * * @param {Json} returns the UserDetails in Json structure

        */

        function getO365UserDetailsAsync(callback) {

            KASClient.getO365UserDetails(function (userDetails, error) {

                var userInfo = KASClient.KASO365User.fromJSON(userDetails);

                if (callback) {

                    callback(userInfo, error);

                }

            });

        }

        App.getO365UserDetailsAsync = getO365UserDetailsAsync;

        /**

        * Gets Forward Context details such as : Card Creation is in forwarded mode

        * @param {Callback} callback with below parameters:

        * * * * @param {Json} returns the Context Details in Json structure

        */

        function getForwardContextAsync(callback) {

            KASClient.getForwardContext(function (contextDetails, error) {

                var context = KASClient.KASForwardContext.fromJSON(contextDetails);

                if (callback) {

                    callback(context, error);

                }

            });

        }

        App.getForwardContextAsync = getForwardContextAsync;

        /**

        * Gets the client details

        * @param {Callback} callback with below parameters:

        * * * * @param {JSON} properties can be null in case of error

        * * * * @param {string} error message in case of error, null otherwise

        */

        function getClientDetailsAsync(callback) {

            KASClient.getClientDetails(callback);

        }

        App.getClientDetailsAsync = getClientDetailsAsync;

        /**

        * Registers a callback to be executed on hardware back button press (for Android)

        * @param {Callback} callback to be executed

        */

        App.hardwareBackPressCallback = null;

        function registerHardwareBackPressCallback(callback) {

            if (callback === void 0) { callback = null; }

            App.hardwareBackPressCallback = callback;

        }

        App.registerHardwareBackPressCallback = registerHardwareBackPressCallback;

        // Will be called from Android Activity's onBackPressed()

        function OnHardwareBackPress() {

            if (App.hardwareBackPressCallback) {

                App.hardwareBackPressCallback();

            }

        }

        App.OnHardwareBackPress = OnHardwareBackPress;

        /**

        * Initializes the localization strings' map

        * @param {Dictionary&lt;StringId: Dictionary&lt;Locale: StringValue>>} the strings' map

        * @param {Callback} callback with below parameters:

        * * * * @param {boolean} success denotes the success/failure of the initialization

        */

        var locInited = false;

        var locJson = null;

        var currentLocale = "en"; // Default

        function initLocalizationStringsAsync(strings, callback) {

            locJson = strings;

            getAppLocaleAsync(function (locale, error2) {

                if (!error2) {

                    currentLocale = locale;

                }

                locInited = (!error2);

                if (callback) {

                    callback(locInited);

                }

            });

        }

        App.initLocalizationStringsAsync = initLocalizationStringsAsync;

        var userStrings = null;

        function setUserStrings(strings) {

            if (strings === void 0) { strings = null; }

            userStrings = strings;

        }

        App.setUserStrings = setUserStrings;

        /**

        * Returns a string from the localized strings' file

        * @param {string} stringId

        */

        function getString(stringId) {

            if (!userStrings &amp;&amp; (!locInited || !locJson)) {

                console.assert(false, "Valid localization file not initialized");

            }

            else {

                // First preference should always be to user provided strings

                if (userStrings &amp;&amp; userStrings.hasOwnProperty(stringId) &amp;&amp; userStrings[stringId]) {

                    return userStrings[stringId];

                }

                else if (locJson.hasOwnProperty(stringId)) {

                    if (locJson[stringId].hasOwnProperty(currentLocale)) {

                        return locJson[stringId][currentLocale];

                    }

                    else {

                        return locJson[stringId]["en"];

                    }

                }

                else {

                    return stringId;

                }

            }

        }

        App.getString = getString;

        /**

           * shows a particular location as mentioned in KASLocation

           * @param {KASLocation} location

         */

        function showLocationOnMap(location) {

            KASClient.showLocationMap(JSON.stringify(location.toJSON()));

        }

        App.showLocationOnMap = showLocationOnMap;

        /**

        * Returns a string.

        * @param {string} string denotes the formatted string. Specifier should be mentioned like {0},{1},{2}.....

        * @param {string[]} args array of arguments.

        */

        function printf(main) {

            var args = [];

            for (var _i = 1; _i &lt; arguments.length; _i++) {

                args[_i - 1] = arguments[_i];

            }

            var formatted = main;

            for (var i = 0; i &lt; args.length; i++) {

                var regexp = new RegExp('\\{' + i + '\\}', 'gi');

                formatted = formatted.replace(regexp, args[i]);

            }

            return formatted;

        }

        App.printf = printf;

        // For internal use.

        function getCurrentLocale() {

            return currentLocale;

        }

        App.getCurrentLocale = getCurrentLocale;

        /**

          * If authentication type is allowed, this API performs the authentication and returns success/false status

          * else it returns an error string with reason why authentication is not possible.

          * @param {KASAuthenticationType} authenticationType type of authentication.

          * @param {Callback} callback with below parameters:

          * * * * @param {boolean} isSuccessful true if the form is not yet expired

          * * * * @param {string} reasonCode reason code in case of error, null otherwise

          */

        function performAuthenticationAsync(authenticationType, callback) {

            if (authenticationType === void 0) { authenticationType = KASClient.KASAuthenticationType.None; }

            KASClient.performAuthentication(authenticationType, function (isActive, reasonCode) {

                if (callback) {

                    callback(isActive, reasonCode);

                }

            });

        }

        App.performAuthenticationAsync = performAuthenticationAsync;

        /**

        * Checks if authentication of type is possible or not.

        * @param {KASAuthenticationType} authenticationType type of authentication.

        * @param {Callback} callback with below parameters:

        * * * * @param {boolean} isSuccessful true if finger printing is possible

        * * * * @param {string} reasonCode reason code why finger print is not possible

        */

        function isAuthenticationTyepSupportedAsync(authenticationType, callback) {

            if (authenticationType === void 0) { authenticationType = KASClient.KASAuthenticationType.None; }

            KASClient.isAuthenticationTypeSupported(authenticationType, function (isSuccessful, reasonCode) {

                if (callback) {

                    callback(isSuccessful, reasonCode);

                }

            });

        }

        App.isAuthenticationTyepSupportedAsync = isAuthenticationTyepSupportedAsync;

        /**

        * Opens native voice to text conversion UI and returns the text for the voice input given by user.

        * @param {Callback} callback with below parameters:

        * * * * @param {boolean} text converted text for the voice input given by user

        * * * * @param {string} error any error that happens in native during voice to speech conversion

        */

        function performSpeechToTextAsync(callback) {

            KASClient.performSpeechToText(function (text, error) {

                if (callback) {

                    callback(text, error);

                }

            });

        }

        App.performSpeechToTextAsync = performSpeechToTextAsync;

        /**

        * Opens given http url in browser. For strings not starting with http, it is a no-op

        * @param {string} httpUrlStr

        */

        function openLinkInBrowser(httpUrlStr) {

            KASClient.openHttpLinkInBrowser(httpUrlStr);

        }

        App.openLinkInBrowser = openLinkInBrowser;

        /**

        * performs an http request and returns the response as specified below:

        * @param {string} url base url to open

        * @param {string} parametersJSON jsonstring containing parameters can be given as null.

        *                                 If given as null a request to the url provided above will be made.

        *                                 Parameters include request header,query parameters(default blank), request method(default GET)

        *                                 and request body(The body to be posted if request method is POST. default blank.)

        *                                 The keys for parameters are:

        *                                 a.) "method" : request method. example: "POST". defaults to "GET".

        *                                 b.) "requestBody": body of request in case of "POST". defaults to blank.

        *                                 c.) "requestHeaders": headers to be sent with request. should be a json with

        *                                                         key as request header and value as the desired value. defaults to blank.

        *                                 d.) "queryParameters": query parameters. will be encoded in url. should be a json with

        *                                                         key as parameter name and value as its value. defaults to blank.

        *                                 e.) "requestResourcePath": will be appended to base url. default is blank.

        * @param {Callback} callback callback with below parameters:

        * * * * @param {string} response response body returned

        *                                This could have two possible config:

        *                               If request was a success it returns jsonstring with following keys:

        *                                a.) "HttpResponseCode" : The response code of request.

        *                               b.) "HttpResponseHeader": The response HTTP headers

        *                               c.) "HttpResponseBody": The response body returned for request.

        *                               If there was a Network error then it returns:

        *                               a.) "HttpErrorCode": The error code

        *                               b.) "HttpErrorMessage": The error message eg. Malformed URL, Cannot connect to host etc.

        * * * * @param {string} error error if any : This includes the standard error code defined in KASClient documentation.

        */

        function performHTTPRequest(url, parametersJSON, callback) {

            if (parametersJSON == null || parametersJSON == undefined) {

                parametersJSON = "";

            }

            KASClient.performHTTPRequestNative(url, parametersJSON, function (response, error) {

                if (callback) {

                    callback(response, error);

                }

            });

        }

        App.performHTTPRequest = performHTTPRequest;

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#cancelAttachmentDownloadAsync">cancelAttachmentDownloadAsync</a></li><li><a href="global.html#dismissCurrentScreen">dismissCurrentScreen</a></li><li><a href="global.html#downloadAttachmentAsync">downloadAttachmentAsync</a></li><li><a href="global.html#generateBase64ThumbnailAsync">generateBase64ThumbnailAsync</a></li><li><a href="global.html#generateUUIDAsync">generateUUIDAsync</a></li><li><a href="global.html#getAppLocaleAsync">getAppLocaleAsync</a></li><li><a href="global.html#getCalendarNameAsync">getCalendarNameAsync</a></li><li><a href="global.html#getClientDetailsAsync">getClientDetailsAsync</a></li><li><a href="global.html#getConversationNameAsync">getConversationNameAsync</a></li><li><a href="global.html#getConversationParticipantsAsync">getConversationParticipantsAsync</a></li><li><a href="global.html#getConversationParticipantsCountAsync">getConversationParticipantsCountAsync</a></li><li><a href="global.html#getConversationTypeAsync">getConversationTypeAsync</a></li><li><a href="global.html#getCurrentDeviceLocationAsync">getCurrentDeviceLocationAsync</a></li><li><a href="global.html#getCurrentUserIdAsync">getCurrentUserIdAsync</a></li><li><a href="global.html#getDeviceIdAsync">getDeviceIdAsync</a></li><li><a href="global.html#getDeviceLocationAsync">getDeviceLocationAsync</a></li><li><a href="global.html#getFontSizeMultiplierAsync">getFontSizeMultiplierAsync</a></li><li><a href="global.html#getForwardContextAsync">getForwardContextAsync</a></li><li><a href="global.html#getIntegerationServiceTokenAsync">getIntegerationServiceTokenAsync</a></li><li><a href="global.html#getIsAppTimeFormat24HoursAsync">getIsAppTimeFormat24HoursAsync</a></li><li><a href="global.html#getLocalizedStringsAsync">getLocalizedStringsAsync</a></li><li><a href="global.html#getO365UserDetailsAsync">getO365UserDetailsAsync</a></li><li><a href="global.html#getPackageCustomSettingsAsync">getPackageCustomSettingsAsync</a></li><li><a href="global.html#getPackagePropertiesAsync">getPackagePropertiesAsync</a></li><li><a href="global.html#getString">getString</a></li><li><a href="global.html#getUsersDetailsAsync">getUsersDetailsAsync</a></li><li><a href="global.html#hasStorageAccessForAttachmentType">hasStorageAccessForAttachmentType</a></li><li><a href="global.html#hideProgressBar">hideProgressBar</a></li><li><a href="global.html#isAttachmentDownloadingAsync">isAttachmentDownloadingAsync</a></li><li><a href="global.html#isAuthenticationTyepSupportedAsync">isAuthenticationTyepSupportedAsync</a></li><li><a href="global.html#isCurrentUserO365SubscribedAsync">isCurrentUserO365SubscribedAsync</a></li><li><a href="global.html#isTalkBackEnabledAsync">isTalkBackEnabledAsync</a></li><li><a href="global.html#locInited">locInited</a></li><li><a href="global.html#logError">logError</a></li><li><a href="global.html#logToReport">logToReport</a></li><li><a href="global.html#openAttachmentImmersiveView">openAttachmentImmersiveView</a></li><li><a href="global.html#openImmersiveViewForAttachmentList">openImmersiveViewForAttachmentList</a></li><li><a href="global.html#openLinkInBrowser">openLinkInBrowser</a></li><li><a href="global.html#performAuthenticationAsync">performAuthenticationAsync</a></li><li><a href="global.html#performHTTPRequest">performHTTPRequest</a></li><li><a href="global.html#performSpeechToTextAsync">performSpeechToTextAsync</a></li><li><a href="global.html#printf">printf</a></li><li><a href="global.html#readTalkBackMessage">readTalkBackMessage</a></li><li><a href="global.html#recordEvent">recordEvent</a></li><li><a href="global.html#recordTelemetryEvent">recordTelemetryEvent</a></li><li><a href="global.html#setCompatibilityMode">setCompatibilityMode</a></li><li><a href="global.html#setNativeToolbarProperties">setNativeToolbarProperties</a></li><li><a href="global.html#showAttachmentPickerAsync">showAttachmentPickerAsync</a></li><li><a href="global.html#showBarcodeScannerAsync">showBarcodeScannerAsync</a></li><li><a href="global.html#showContactPickerAsync">showContactPickerAsync</a></li><li><a href="global.html#showDurationPickerAsync">showDurationPickerAsync</a></li><li><a href="global.html#showImageImmersiveView">showImageImmersiveView</a></li><li><a href="global.html#showImagePickerAsync">showImagePickerAsync</a></li><li><a href="global.html#showLocationOnMap">showLocationOnMap</a></li><li><a href="global.html#showNativeErrorMessage">showNativeErrorMessage</a></li><li><a href="global.html#showPlacePickerAsync">showPlacePickerAsync</a></li><li><a href="global.html#showProgressBar">showProgressBar</a></li><li><a href="global.html#showQRcodeScannerAsync">showQRcodeScannerAsync</a></li><li><a href="global.html#showUserProfileAsync">showUserProfileAsync</a></li><li><a href="global.html#startChatAsync">startChatAsync</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Nov 14 2018 16:00:15 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
